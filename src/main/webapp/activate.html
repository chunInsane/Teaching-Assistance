<!DOCTYPE html>
<html lang="cmn-Hans-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Teach-Assistance</title>

    <!-- Bootstrap -->
    <link href="/resources/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- <link href="/resources/css/main.css" rel="stylesheet"> -->
    <link href="/resources/css/login.css" rel="stylesheet">
    <link rel="shortcut icon" href="/resources/img/head.ico">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        #activate {
            padding-top: 80px;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top elevation-4">
    <div class="container" class="elevation-4" translate="my-transition">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header ">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href=" ">Teach-Assistance</a >
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active"><a href="#">首页 <span class="sr-only">(current)</span></a ></li>
                <li><a href="#">考前练习</a ></li>
                <li><a href="#">编程比赛</a ></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>
<!-- nav bar end -->

<div class="container">
    <div id="activate" class="col-md-4 col-md-offset-4">

        <form class="form-horizontal">
            <div class="form-group">
                <label class="control-label col-md-3" for="inputUsername">用户邮箱</label>
                <div class="controls col-md-9">
                    <input class="form-control" type="text" id="inputUsername" readonly placeholder="用户邮箱">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-md-3" for="inputPassword">密码</label>
                <div class="controls col-md-9">
                    <input class="form-control" type="password" id="inputPassword" placeholder="">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-md-3" for="inputRepeatPassword">重复密码</label>
                <div class="controls col-md-9">
                    <input class="form-control" type="password" id="inputRepeatPassword" placeholder="">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-md-3" for="inputNickname">昵称</label>
                <div class="controls col-md-9">
                    <input class="form-control" type="text" id="inputNickname" placeholder="昵称">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-md-3">性别</label>
                <div class="controls col-md-9">
                    <label class="radio-inline">
                        <input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="0">
                        Female
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="1">
                        Male
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-md-3" for="inputSchool">学校</label>
                <div class="controls col-md-9">
                    <input class="form-control" type="text" id="inputSchool" placeholder="学校">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-md-3" for="inputMobilePhone">联系电话</label>
                <div class="controls col-md-9">
                    <input class="form-control" type="text" id="inputMobilePhone" placeholder="联系电话">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-md-3" for="inputMotto">个性签名</label>
                <div class="controls col-md-9">
                    <input class="form-control" type="text" id="inputMotto" placeholder="个性签名">
                </div>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary col-md-offset-4">activate</button>
                <button type="reset" class="btn btn-primary col-md-offset-1">reset</button>
            </div>
        </form>
    </div>
</div>


<!-- footer start -->
<footer class="footer col-xs-12">
    <!-- <hr class="colorful"> -->
    <div class="container text-center">
        <span>All Rights Reversed.</span>
        <span>邮箱：<a href="mailto:teach_assistance@163.com">teach_assistance@163.com</a ></span>
        <span>联系地址：山西省太原市尖草坪区学院路3号</span>
    </div>
</footer>
<!-- footer end -->

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="/resources/lib/vue/dist/vue.js"></script>
<script src="/resources/lib/jquery/dist/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/resources/lib/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/resources/lib/layer/layer.js"></script>
<script src="/resources/js/main.js"></script>
<script>
    "use strict"
    Vue.config.debug = true;
    let app = new Vue({
        el: "#login",
        data:{
            disshowlogin: false,       // 显示登录框
            disshowregister: true,     // 显示注册框
            login_email: "",           // 登录邮箱
            login_password: "",        // 登录密码
            register_email: "",        // 注册邮箱
            register_verifycode: "",   // 注册验证码
            errInfoEmail:"",           // 登录错误提示 email
            errInfoPwd:"",             // 登录错误提示 pwd
            errInfoRE:"",              // 注册错误提示 email
            errInfoVCode:"",           // 注册错误提示 verfiyCode
        },
        methods:{
            /**
             * 显示登录框
             */
            showLoginBar: function(){
                this.disshowlogin = false;
                this.disshowregister = true;
                return false;
            },
            /**
             * 显示注册框
             */
            showRegisterBar: function(){
                this.disshowlogin = true;
                this.disshowregister = false;
                return false;
            },
            /**
             * 登录事件
             */
            login: function(){
                let data = {
                    "userName" : this.login_email,
                    "password": this.login_password,
                };
                if( typeof data.userName === "undefined" ||
                        typeof data.password === "undefined" ||
                        data.userName.length <= 0 ||
                        data.password.length <= 0){
                    layer.msg("输入不能为空!");
                    return false;
                }
                $.ajax({
                    method:"post",
                    data:JSON.stringify(data),
                    dataType:"json",
                    contentType:"application/json",
                    url:"/user/login",
                    error: function(msg){
                        layer.msg("请求失败!" + msg.message);
                    },
                }).done(function(msg){
                    if(msg.status === 200){
                        layer.msg("登录成功!")
                        window.location.href = "/home/index.html";
                    }else{
                        switch (msg.status) {
                            case 401:
                                layer.alert("未授权的操作!");
                                break;

                            case 402:
                                layer.msg("登录超时!");
                                window.location = "/"; // 回到首页
                                break;

                            case 403:
                                layer.msg("未登录!");
                                window.location = "/"; // 回到首页
                                break;

                            case 404:
                                layer.msg("页面不存在!");
                                window.location = "/"; // 回到首页
                                break;

                            case 500:
                                app.errInfoEmail = msg.errors.userName;
                                app.errInfoPwd = msg.errors.password;
                                break;

                            default:
                                break;
                        }
                    }
                });
                // console.log("login");

            },
            /**
             * 注册事件
             */
            register: function(){
                let data = {
                    "username" : this.register_email,
                    "validateCode": this.register_verifycode,
                };
                if( typeof data.username === "undefined" ||
                        typeof data.validateCode === "undefined" ||
                        data.username.length <= 0 ||
                        data.validateCode.length <= 0){
                    layer.msg("输入不能为空!");
                    return false;
                }
                $.ajax({
                    method:"post",
                    data:JSON.stringify(data),
                    dataType:"json",
                    url:"/user/register",
                    contentType:"application/json",
                    error: function(msg){
                        layer.msg("请求失败!" + msg.message);
                    },
                }).done(function(msg){
                    if(msg.status === 200){
                        layer.alert("激活邮件已发送,请注意查收!");
                    }else{
                        switch (msg.status) {
                            case 401:
                                layer.alert("未授权的操作!");
                                break;

                            case 402:
                                layer.msg("登录超时!");
                                window.location = "/"; // 回到首页
                                break;

                            case 403:
                                layer.msg("未登录!");
                                window.location = "/"; // 回到首页
                                break;

                            case 404:
                                layer.msg("页面不存在!");
                                window.location = "/"; // 回到首页
                                break;

                            case 500:
                                app.errInfoRE = msg.errors.username;
                                app.errInfoVCode = msg.errors.validateCode;
                                console.log('/captcha?'+Math.random());
                                $("#captcha").attr("src", '/captcha?'+Math.random());
                                break;

                            default:
                                break;
                        }
                    }
                });
                // console.log("login");

            },
        },
    });
</script>
</body>
</html>